
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solution: effect of clouds on the planetary energy balance &#8212; Physics of the Climate System</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.da26317cf37e5c4af2fa3e6253912353.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lesson: working with netCDF data" href="../week_02/01_Lesson_NetCDF_Data.html" />
    <link rel="prev" title="Assignment: effect of clouds on the planetary energy balance" href="02_Assignment_Simple_cloud_effects.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Physics of the Climate System</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../welcome.html">
   Welcome
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html">
   Getting started with Jupyter Notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../primer.html">
   Python and Jupyter: a primer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../download.html">
   Downloading the data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../howto.html">
   How to use this website and prepare for each week
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 01
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Lesson_Conservation_of_momentum.html">
   Lesson: Conservation of angular momentum and Hadley circulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Assignment_Simple_cloud_effects.html">
   Assignment: effect of clouds on the planetary energy balance
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Solution: effect of clouds on the planetary energy balance
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 02
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02/01_Lesson_NetCDF_Data.html">
   Lesson: working with netCDF data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02/02_Assignment_CERES_data.html">
   Assignment: CERES data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02/03_Solution_CERES_data.html">
   Solution: CERES data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 03
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_03/01_Lesson_MoreDataCrunching.html">
   Lesson: more tools for statistical and climatological analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_03/02_Assignment_TemperaturePrecipitation.html">
   Assignment: temperature and precipitation data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_03/03_Solution_TemperaturePrecipitation.html">
   Solution: temperature and precipitation data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 04
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/01_Lesson_Wind-Derivatives-Integrals.html">
   Lesson: wind flow, 4D data, numerical integrals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/02_Assignment_GeneralCirculation.html">
   Assignment: major features of the atmospheric circulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04/03_Solution_GeneralCirculation.html">
   Solution: major features of the atmospheric circulation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 05
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05/01_GuidedExercise_EnergyTransport.html">
   Guided exercise: Energy Transport
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05/02_Assignment_EkmanPumping.html">
   Assignment: Ekman Pumping
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Week 06
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_06/01_GuidedExercise_Composites.html">
   Guided exercise: indices, composites, correlation maps
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Final Projects
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/01_FinalProjects.html">
   Final group projects: instructions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/02_Getting_started_RegionalPlots.html">
   Regional PlateCarree projection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/03_Getting_started_NorthAmerica.html">
   Lambert conformal projection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects/04_Getting_started_Antarctica.html">
   Polar stereographic projection
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/week_01/03_Solution_Simple_cloud_effects.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/fmaussion/climate_system"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/fmaussion/climate_system/issues/new?title=Issue%20on%20page%20%2Fweek_01/03_Solution_Simple_cloud_effects.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/fmaussion/climate_system/edit/master/book/week_01/03_Solution_Simple_cloud_effects.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/fmaussion/climate_system/master?urlpath=lab/tree/book/week_01/03_Solution_Simple_cloud_effects.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#effect-of-low-clouds-on-the-eb">
   Effect of low clouds on the EB
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#effect-of-high-clouds-on-the-eb">
   Effect of high clouds on the EB
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#and-now-automate-things-a-little-bit">
   And now automate things a little bit
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="solution-effect-of-clouds-on-the-planetary-energy-balance">
<h1>Solution: effect of clouds on the planetary energy balance<a class="headerlink" href="#solution-effect-of-clouds-on-the-planetary-energy-balance" title="Permalink to this headline">¶</a></h1>
<p>In this exercise you are going to compute the effect of clouds on the planetary energy balance, with the help of a simple 1-column model of the atmosphere.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># These are the modules we need</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>We define some constants:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_0</span> <span class="o">=</span> <span class="mi">1367</span>  <span class="c1"># Solar constant (W m-2)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.670e-8</span>  <span class="c1"># Stefan–Boltzmann constant</span>
<span class="n">t_s</span> <span class="o">=</span> <span class="mi">288</span>  <span class="c1"># Average temperature of the Earth&#39;s surface (K)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.5</span>  <span class="c1"># Lapse-rate in the atmoshpere (K km-1)</span>
<span class="n">surface_albedo</span> <span class="o">=</span> <span class="mf">0.12</span>  <span class="c1"># Albedo of the surface of the Earth</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="effect-of-low-clouds-on-the-eb">
<h2>Effect of low clouds on the EB<a class="headerlink" href="#effect-of-low-clouds-on-the-eb" title="Permalink to this headline">¶</a></h2>
<p>To isolate the effect of clouds, we assume a very simple representation of the atmosphere as a simple column, free of other greenhouse gases and other clouds. The Temperature of the cloud would then be:</p>
<p><span class="math notranslate nohighlight">\(T_{Cloud} = T_{Surface} + \gamma \, z \)</span>,</p>
<p>with <span class="math notranslate nohighlight">\(z\)</span> the cloud altitude (km) and <span class="math notranslate nohighlight">\(\gamma\)</span> the lapse-rate.</p>
<p><strong>Q: compute the temperature (K) of a cloud at z = 2km, assuming a constant lapse rate and an average surface temperature of 288K:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_c</span> <span class="o">=</span> <span class="n">t_s</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gamma</span>
<span class="s1">&#39;T_C = </span><span class="si">{}</span><span class="s1"> K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t_c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;T_C = 275.0 K&#39;
</pre></div>
</div>
</div>
</div>
<p>Now assume that the cloud absorbs all the IR radiation emited by the surface (a reasonable approximation), while emmitting IR directly back to space according to its own temperature. So the total energy change of the climate system in the longwave (LW) spectrum would be:</p>
<p><span class="math notranslate nohighlight">\(\Delta E_{LW} = \sigma T_{Surf}^4 - \sigma T_{Cloud}^4\)</span></p>
<p><strong>Q: compute the effect of a low cloud on the LW energy balance of the climate system. Is the cloud a LW energy loss or an energy gain for the system?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e_lw</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_s</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_c</span><span class="o">**</span><span class="mi">4</span>
<span class="s1">&#39;Delta E_LW = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_lw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Delta E_LW = 65.8 W m^-2&#39;
</pre></div>
</div>
</div>
</div>
<p>Now consider the shortwave effects of the cloud if it has an albedo of 0.5. The net difference for the climate system is simply the increased loss in solar energy because of an increased reflection:</p>
<p><span class="math notranslate nohighlight">\(\Delta E_{SW} = - S_0 / 4 \cdot (\alpha _{Cloud} - \alpha _{Earth} ) \)</span></p>
<p><strong>Q: compute the effect of a low cloud on the shortwave (SW) energy balance of the climate system. Is the cloud a SW energy loss or an energy gain for the system?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e_sw</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s_0</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">surface_albedo</span><span class="p">)</span>
<span class="s1">&#39;Delta E_SW = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_sw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Delta E_SW = -129.9 W m^-2&#39;
</pre></div>
</div>
</div>
</div>
<p>Finally, the net energy difference for the climate system is:</p>
<p><span class="math notranslate nohighlight">\(\Delta E_{TOT} = \Delta E_{SW} + \Delta E_{LW}\)</span></p>
<p><strong>Q: compute the effect of a low cloud on the total (SW + LW) energy balance of the climate system. Is the low cloud a total energy loss or an energy gain for the system?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e_tot</span> <span class="o">=</span> <span class="n">e_sw</span> <span class="o">+</span> <span class="n">e_lw</span>
<span class="s1">&#39;Delta E_TOT = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_tot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;Delta E_TOT = -64.1 W m^-2&#39;
</pre></div>
</div>
</div>
</div>
<p><span style="color:red"> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <strong>Low-level</strong> clouds are <strong>cooling</strong> the climate system</span></p>
</div>
<div class="section" id="effect-of-high-clouds-on-the-eb">
<h2>Effect of high clouds on the EB<a class="headerlink" href="#effect-of-high-clouds-on-the-eb" title="Permalink to this headline">¶</a></h2>
<p><strong>Q: repeat the calculations above to compute the effect of a high cloud (z = 10km, albedo unchanged) on the total energy balance of the climate system. Is the high cloud a total energy loss or an energy gain for the system?</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_c</span> <span class="o">=</span> <span class="n">t_s</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">gamma</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;T_C = </span><span class="si">{}</span><span class="s1"> K&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t_c</span><span class="p">))</span>
<span class="n">e_lw</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_s</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_c</span><span class="o">**</span><span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta E_LW = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_lw</span><span class="p">))</span>
<span class="n">e_sw</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s_0</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">surface_albedo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta E_SW = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_sw</span><span class="p">))</span>
<span class="n">e_tot</span> <span class="o">=</span> <span class="n">e_sw</span> <span class="o">+</span> <span class="n">e_lw</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Delta E_TOT = </span><span class="si">{0:.1f}</span><span class="s1"> W m^-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e_tot</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T_C = 223.0 K
Delta E_LW = 249.9 W m^-2
Delta E_SW = -129.9 W m^-2
Delta E_TOT = 120.0 W m^-2
</pre></div>
</div>
</div>
</div>
<p><span style="color:red"> <span class="math notranslate nohighlight">\(\rightarrow\)</span> <strong>High-level</strong> clouds are <strong>warming</strong> the climate system </span></p>
</div>
<div class="section" id="and-now-automate-things-a-little-bit">
<h2>And now automate things a little bit<a class="headerlink" href="#and-now-automate-things-a-little-bit" title="Permalink to this headline">¶</a></h2>
<p><strong>Q: repeat the calculations above for the whole range of altitudes between 2 and 10 km (see the previous lesson for how to do this). Plot the curve.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cloud_effect</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">albedo</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the effect of clouds as a function of the altitude z and the cloud albedo (default 0.5)&quot;&quot;&quot;</span>
    <span class="n">t_c</span> <span class="o">=</span> <span class="n">t_s</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">gamma</span>
    <span class="n">e_lw</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_s</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">t_c</span><span class="o">**</span><span class="mi">4</span>
    <span class="n">e_sw</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s_0</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">albedo</span> <span class="o">-</span> <span class="n">surface_albedo</span><span class="p">)</span>
    <span class="n">e_tot</span> <span class="o">=</span> <span class="n">e_sw</span> <span class="o">+</span> <span class="n">e_lw</span>
    <span class="k">return</span> <span class="n">e_tot</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Q: repeat the calculations above, for three values of the cloud albedo: 0.3, 0.5, 0.7. Plot the three curves on the same plot and add a legend to the plots (see the “Getting started” notebook for guidance).</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># altitude range</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">cloud_effect</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">albedo</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Albedo=0.3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">cloud_effect</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">albedo</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Albedo=0.5&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">cloud_effect</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">albedo</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Albedo=0.7&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Cloud altitude (km)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\Delta E$ (W m$^{-2}$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03_Solution_Simple_cloud_effects_27_0.png" src="../_images/03_Solution_Simple_cloud_effects_27_0.png" />
</div>
</div>
<p><strong>Q: discuss the features of the plot, and the conditions necessary for a cloud to be an energy gain or an energy loss for the climate system. Now search for typical values of cloud albedos depending on their type, and come back to your plot for comparison.</strong></p>
<p>If you complicate things a bit by noticing that high clouds have a low albedo and low clouds a high albedo while thick clouds have a high albedo but also a high cloud top you can imagine that the system becomes extremely sensitive.</p>
<p><strong>The processes governing cloud albedo are extremely complex. The uncertainty about changes in the clouds frequency, altitude, and albedo are one of the highest uncertainty in the climate models.</strong></p>
<p>More info on <a class="reference external" href="http://www.skepticalscience.com/clouds-negative-feedback-basic.htm">Skeptikal Science’s page on the topic</a> (basic and intermediate)</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./week_01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="02_Assignment_Simple_cloud_effects.html" title="previous page">Assignment: effect of clouds on the planetary energy balance</a>
    <a class='right-next' id="next-link" href="../week_02/01_Lesson_NetCDF_Data.html" title="next page">Lesson: working with netCDF data</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Fabien Maussion<br/>
        
          <div class="extra_footer">
            <p>
<a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">
  <img align="right" class="margin" src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by.svg" width="88px">
</a>
These lecture notes and exercises are licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International (CC BY 4.0) license</a>.
<br>
&copy; Copyright 2018-2020.
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-88391345-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>